<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LexiScraper Pro | Análisis Léxico Avanzado</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2c3e50;
            --primary-dark: #1a252f;
            --primary-light: #34495e;
            --secondary: #3498db;
            --secondary-dark: #2980b9;
            --accent: #16a085;
            --accent-dark: #1abc9c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --gray: #95a5a6;
            --gray-light: #bdc3c7;
            --success: #27ae60;
            --warning: #f39c12;
            --error: #e74c3c;
            --text: #2c3e50;
            --text-light: #7f8c8d;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
            --radius: 8px;
            --transition: all 0.3s ease;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8eb 100%);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
        }
        
        @media (max-width: 1100px) {
            .container {
                grid-template-columns: 1fr;
            }
        }
        
        .card {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 25px;
            transition: var(--transition);
        }
        
        .card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }
        
        header {
            grid-column: 1 / -1;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .logo-icon {
            background: var(--primary);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }
        
        h1 {
            color: var(--primary);
            font-weight: 600;
            font-size: 2.2rem;
            margin: 0;
        }
        
        .tagline {
            color: var(--text-light);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .input-section {
            display: flex;
            margin-bottom: 25px;
            gap: 12px;
        }
        
        .url-input-container {
            flex: 1;
            position: relative;
        }
        
        #url-input {
            width: 100%;
            padding: 15px 20px;
            border: 1px solid var(--gray-light);
            border-radius: var(--radius);
            font-size: 1rem;
            transition: var(--transition);
            background: white;
        }
        
        #url-input:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .btn {
            padding: 15px 25px;
            background-color: var(--secondary);
            color: white;
            border: none;
            border-radius: var(--radius);
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn:hover {
            background-color: var(--secondary-dark);
            transform: translateY(-2px);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-success {
            background-color: var(--success);
        }
        
        .btn-success:hover {
            background-color: #219653;
        }
        
        .btn-accent {
            background-color: var(--accent);
        }
        
        .btn-accent:hover {
            background-color: var(--accent-dark);
        }
        
        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--gray-light);
            color: var(--text);
        }
        
        .btn-outline:hover {
            background-color: var(--light);
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 12px;
            margin-bottom: 25px;
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .stat-card {
            background: var(--light);
            padding: 20px;
            border-radius: var(--radius);
            text-align: center;
            transition: var(--transition);
        }
        
        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        .section-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            color: var(--primary);
            font-size: 1.2rem;
        }
        
        .section-title i {
            color: var(--secondary);
        }
        
        .words-container {
            border: 1px solid var(--gray-light);
            border-radius: var(--radius);
            padding: 20px;
            height: 350px;
            overflow-y: auto;
            background: white;
        }
        
        .words-list {
            list-style-type: none;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
        }
        
        .words-list li {
            padding: 10px 15px;
            background: var(--light);
            border-radius: 30px;
            text-align: center;
            font-size: 0.9rem;
            transition: var(--transition);
        }
        
        .words-list li:hover {
            background: var(--secondary);
            color: white;
            transform: translateY(-2px);
        }
        
        .frequent-words-list {
            list-style-type: none;
        }
        
        .frequent-words-list li {
            padding: 12px 15px;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            justify-content: space-between;
            transition: var(--transition);
        }
        
        .frequent-words-list li:hover {
            background: var(--light);
        }
        
        .frequent-words-list li:last-child {
            border-bottom: none;
        }
        
        .word-frequency {
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        .export-section {
            display: flex;
            justify-content: center;
            margin-top: 25px;
        }
        
        .loading {
            display: none;
            text-align: center;
            margin: 20px 0;
        }
        
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: var(--secondary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .message {
            padding: 15px;
            border-radius: var(--radius);
            margin: 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .message.success {
            background: rgba(39, 174, 96, 0.1);
            color: var(--success);
            border-left: 4px solid var(--success);
        }
        
        .message.error {
            background: rgba(231, 76, 60, 0.1);
            color: var(--error);
            border-left: 4px solid var(--error);
        }
        
        .message.info {
            background: rgba(52, 152, 219, 0.1);
            color: var(--secondary);
            border-left: 4px solid var(--secondary);
        }
        
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-light);
        }
        
        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: var(--gray-light);
        }
        
        footer {
            grid-column: 1 / -1;
            text-align: center;
            margin-top: 40px;
            color: var(--text-light);
            font-size: 0.9rem;
            padding-top: 20px;
            border-top: 1px solid var(--gray-light);
        }
        
        /* Barra de progreso */
        .progress-container {
            margin: 20px 0;
            background-color: var(--gray-light);
            border-radius: 10px;
            height: 10px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary), var(--accent));
            border-radius: 10px;
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 0.9rem;
            color: var(--text-light);
        }
        
        .progress-steps {
            margin-top: 15px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .progress-step {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
        }
        
        .step-icon {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--gray-light);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            color: white;
        }
        
        .step-icon.active {
            background: var(--secondary);
        }
        
        .step-icon.completed {
            background: var(--success);
        }
        
        /* Configuración avanzada */
        .advanced-settings {
            background: var(--light);
            padding: 20px;
            border-radius: var(--radius);
            margin-top: 20px;
        }
        
        .settings-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            margin-bottom: 15px;
        }
        
        .settings-content {
            display: none;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .settings-content.show {
            display: grid;
        }
        
        .setting-group {
            margin-bottom: 15px;
        }
        
        .setting-label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .setting-input {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--gray-light);
            border-radius: var(--radius);
        }
        
        .setting-checkbox {
            margin-right: 8px;
        }
        
        /* Scrollbar personalizado */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--gray);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-light);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-language"></i>
                </div>
                <h1>LexiScraper Pro</h1>
            </div>
            <p class="tagline">Análisis léxico avanzado con scraping profundo y barra de progreso</p>
        </header>
        
        <div class="card">
            <div class="section-title">
                <i class="fas fa-cloud-download-alt"></i>
                <h2>Extracción de Contenido</h2>
            </div>
            
            <div class="input-section">
                <div class="url-input-container">
                    <input type="text" id="url-input" placeholder="https://ejemplo.com">
                </div>
                <button id="scrape-btn" class="btn">
                    <i class="fas fa-download"></i> Extraer
                </button>
            </div>
            
            <!-- Barra de progreso -->
            <div class="progress-container" id="progress-container">
                <div class="progress-info">
                    <span id="progress-text">Preparando...</span>
                    <span id="progress-percent">0%</span>
                </div>
                <div class="progress-bar" id="progress-bar"></div>
                
                <div class="progress-steps" id="progress-steps">
                    <!-- Los pasos se agregarán dinámicamente -->
                </div>
            </div>
            
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p id="loading-text">Analizando contenido web...</p>
            </div>
            
            <div id="message"></div>
            
            <!-- Configuración avanzada -->
            <div class="advanced-settings">
                <div class="settings-toggle" id="settings-toggle">
                    <i class="fas fa-cogs"></i>
                    <h3>Configuración Avanzada</h3>
                    <i class="fas fa-chevron-down" id="settings-chevron"></i>
                </div>
                
                <div class="settings-content" id="settings-content">
                    <div class="setting-group">
                        <label class="setting-label">Profundidad de scraping</label>
                        <select class="setting-input" id="depth-select">
                            <option value="1">Página principal solamente</option>
                            <option value="2">Página principal + enlaces internos (1 nivel)</option>
                            <option value="3" selected>Página principal + enlaces internos (2 niveles)</option>
                            <option value="4">Máxima profundidad (3 niveles)</option>
                        </select>
                    </div>
                    
                    <div class="setting-group">
                        <label class="setting-label">Límite de páginas a analizar</label>
                        <input type="number" class="setting-input" id="page-limit" value="10" min="1" max="50">
                    </div>
                    
                    <div class="setting-group">
                        <label class="setting-label">Longitud mínima de palabras</label>
                        <input type="number" class="setting-input" id="min-length" value="3" min="1" max="10">
                    </div>
                    
                    <div class="setting-group">
                        <label class="setting-label">Filtrar palabras comunes</label>
                        <input type="checkbox" class="setting-checkbox" id="filter-common" checked>
                        <label for="filter-common">Excluir palabras muy comunes (artículos, preposiciones)</label>
                    </div>
                    
                    <div class="setting-group">
                        <label class="setting-label">Incluir enlaces externos</label>
                        <input type="checkbox" class="setting-checkbox" id="include-external">
                        <label for="include-external">Analizar también enlaces a otros dominios</label>
                    </div>
                    
                    <div class="setting-group">
                        <label class="setting-label">Tiempo máximo de espera (segundos)</label>
                        <input type="number" class="setting-input" id="timeout" value="30" min="5" max="120">
                    </div>
                </div>
            </div>
            
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-value" id="word-count">0</div>
                    <div class="stat-label">Palabras Únicas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="char-count">0</div>
                    <div class="stat-label">Caracteres Totales</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="pages-count">0</div>
                    <div class="stat-label">Páginas Analizadas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="links-count">0</div>
                    <div class="stat-label">Enlaces Encontrados</div>
                </div>
            </div>
        </div>
        
        <div class="card">
            <div class="section-title">
                <i class="fas fa-list-ul"></i>
                <h2>Palabras Extraídas</h2>
            </div>
            
            <div class="words-container">
                <ul class="words-list" id="words-list">
                    <div class="empty-state" id="empty-words">
                        <i class="fas fa-language"></i>
                        <p>No hay palabras extraídas aún</p>
                        <p>Ingresa una URL y haz clic en Extraer</p>
                    </div>
                </ul>
            </div>
            
            <div class="export-section">
                <button id="export-btn" class="btn btn-success">
                    <i class="fas fa-file-export"></i> Exportar a Archivo de Texto
                </button>
            </div>
        </div>
        
        <div class="card">
            <div class="section-title">
                <i class="fas fa-chart-bar"></i>
                <h2>Estadísticas de Frecuencia</h2>
            </div>
            
            <div class="words-container">
                <ul class="frequent-words-list" id="frequent-words">
                    <div class="empty-state" id="empty-freq">
                        <i class="fas fa-chart-pie"></i>
                        <p>No hay datos de frecuencia disponibles</p>
                    </div>
                </ul>
            </div>
        </div>
        
        <div class="card">
            <div class="section-title">
                <i class="fas fa-info-circle"></i>
                <h2>Información del Análisis</h2>
            </div>
            
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-value" id="current-url">-</div>
                    <div class="stat-label">URL Actual</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="scrape-time">0s</div>
                    <div class="stat-label">Tiempo de Análisis</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="unique-percent">0%</div>
                    <div class="stat-label">Palabras Únicas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="efficiency">0/s</div>
                    <div class="stat-label">Palabras por Segundo</div>
                </div>
            </div>
            
            <div class="section-title">
                <i class="fas fa-sitemap"></i>
                <h2>Estructura del Sitio</h2>
            </div>
            
            <div class="words-container">
                <ul class="frequent-words-list" id="site-structure">
                    <div class="empty-state" id="empty-structure">
                        <i class="fas fa-sitemap"></i>
                        <p>No hay datos de estructura disponibles</p>
                    </div>
                </ul>
            </div>
        </div>
        
        <footer>
            <p>LexiScraper Pro &copy; 2023 | Herramienta de análisis léxico avanzado para investigación y estudio</p>
        </footer>
    </div>

    <script>
        // Variables globales
        let wordsSet = new Set();
        let currentWords = [];
        let wordFrequency = {};
        let totalWordsFromPage = 0;
        let scrapeStartTime = 0;
        let pagesAnalyzed = 0;
        let linksFound = 0;
        let currentProgress = 0;
        let progressSteps = [];
        
        // Elementos del DOM
        const urlInput = document.getElementById('url-input');
        const scrapeBtn = document.getElementById('scrape-btn');
        const loading = document.getElementById('loading');
        const loadingText = document.getElementById('loading-text');
        const messageDiv = document.getElementById('message');
        const wordCountSpan = document.getElementById('word-count');
        const charCountSpan = document.getElementById('char-count');
        const pagesCountSpan = document.getElementById('pages-count');
        const linksCountSpan = document.getElementById('links-count');
        const currentUrlSpan = document.getElementById('current-url');
        const scrapeTimeSpan = document.getElementById('scrape-time');
        const uniquePercentSpan = document.getElementById('unique-percent');
        const efficiencySpan = document.getElementById('efficiency');
        const wordsList = document.getElementById('words-list');
        const frequentWordsList = document.getElementById('frequent-words');
        const siteStructureList = document.getElementById('site-structure');
        const emptyWords = document.getElementById('empty-words');
        const emptyFreq = document.getElementById('empty-freq');
        const emptyStructure = document.getElementById('empty-structure');
        const sortAscBtn = document.getElementById('sort-asc');
        const sortDescBtn = document.getElementById('sort-desc');
        const sortLengthAscBtn = document.getElementById('sort-length-asc');
        const sortLengthDescBtn = document.getElementById('sort-length-desc');
        const filterShortBtn = document.getElementById('filter-short');
        const filterLongBtn = document.getElementById('filter-long');
        const clearWordsBtn = document.getElementById('clear-words');
        const exportBtn = document.getElementById('export-btn');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        const progressPercent = document.getElementById('progress-percent');
        const progressStepsContainer = document.getElementById('progress-steps');
        const settingsToggle = document.getElementById('settings-toggle');
        const settingsContent = document.getElementById('settings-content');
        const settingsChevron = document.getElementById('settings-chevron');
        
        // Configuración
        const depthSelect = document.getElementById('depth-select');
        const pageLimitInput = document.getElementById('page-limit');
        const minLengthInput = document.getElementById('min-length');
        const filterCommonCheckbox = document.getElementById('filter-common');
        const includeExternalCheckbox = document.getElementById('include-external');
        const timeoutInput = document.getElementById('timeout');
        
        // Palabras comunes a filtrar (si está activada la opción)
        const commonWords = new Set([
            'el', 'la', 'los', 'las', 'un', 'una', 'unos', 'unas', 
            'de', 'del', 'al', 'a', 'en', 'y', 'o', 'pero', 'por', 
            'para', 'con', 'sin', 'sobre', 'bajo', 'entre', 'hacia', 
            'desde', 'hasta', 'durante', 'mediante', 'según', 'ante', 
            'bajo', 'cabe', 'con', 'contra', 'de', 'desde', 'durante', 
            'en', 'entre', 'hacia', 'hasta', 'mediante', 'para', 'por', 
            'según', 'sin', 'so', 'sobre', 'tras', 'versus', 'vía', 
            'que', 'qué', 'cual', 'cuál', 'quien', 'quién', 'cuyo', 
            'cuya', 'cuyos', 'cuyas', 'donde', 'dónde', 'como', 'cómo', 
            'cuando', 'cuándo', 'cuanto', 'cuánto', 'cuanta', 'cuánta', 
            'cuantos', 'cuántos', 'cuantas', 'cuántas'
        ]);
        
        // Función para mostrar mensajes
        function showMessage(text, type = 'info') {
            const icon = type === 'success' ? 'fa-check-circle' : 
                         type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle';
            
            messageDiv.innerHTML = `
                <div class="message ${type}">
                    <i class="fas ${icon}"></i>
                    <span>${text}</span>
                </div>
            `;
            
            setTimeout(() => {
                messageDiv.innerHTML = '';
            }, 5000);
        }
        
        // Función para actualizar la barra de progreso
        function updateProgress(percent, text) {
            currentProgress = percent;
            progressBar.style.width = `${percent}%`;
            progressPercent.textContent = `${percent}%`;
            progressText.textContent = text;
        }
        
        // Función para agregar pasos de progreso
        function setupProgressSteps(steps) {
            progressStepsContainer.innerHTML = '';
            progressSteps = steps;
            
            steps.forEach((step, index) => {
                const stepElement = document.createElement('div');
                stepElement.className = 'progress-step';
                
                const icon = document.createElement('div');
                icon.className = 'step-icon';
                icon.innerHTML = '<i class="fas fa-clock"></i>';
                
                const text = document.createElement('span');
                text.textContent = step;
                
                stepElement.appendChild(icon);
                stepElement.appendChild(text);
                progressStepsContainer.appendChild(stepElement);
                
                // Guardar referencia al icono para actualizarlo después
                progressSteps[index] = {
                    text: step,
                    icon: icon
                };
            });
        }
        
        // Función para actualizar un paso de progreso
        function updateProgressStep(stepIndex, status) {
            if (progressSteps[stepIndex] && progressSteps[stepIndex].icon) {
                const icon = progressSteps[stepIndex].icon;
                icon.className = 'step-icon';
                
                if (status === 'completed') {
                    icon.innerHTML = '<i class="fas fa-check"></i>';
                    icon.classList.add('completed');
                } else if (status === 'active') {
                    icon.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
                    icon.classList.add('active');
                } else {
                    icon.innerHTML = '<i class="fas fa-clock"></i>';
                }
            }
        }
        
        // Función para actualizar estadísticas
        function updateStats() {
            wordCountSpan.textContent = wordsSet.size;
            
            // Calcular caracteres totales
            const totalChars = Array.from(wordsSet).reduce((sum, word) => sum + word.length, 0);
            charCountSpan.textContent = totalChars.toLocaleString();
            
            pagesCountSpan.textContent = pagesAnalyzed;
            linksCountSpan.textContent = linksFound;
            currentUrlSpan.textContent = urlInput.value ? new URL(urlInput.value).hostname : '-';
            
            // Calcular porcentaje de palabras únicas
            const uniquePercent = totalWordsFromPage > 0 ? 
                ((wordsSet.size / totalWordsFromPage) * 100).toFixed(1) : 0;
            uniquePercentSpan.textContent = `${uniquePercent}%`;
            
            // Calcular eficiencia (palabras únicas / tiempo de scraping)
            const scrapeTime = (Date.now() - scrapeStartTime) / 1000;
            scrapeTimeSpan.textContent = `${scrapeTime.toFixed(1)}s`;
            
            const efficiency = scrapeTime > 0 ? 
                Math.round(wordsSet.size / scrapeTime) : 0;
            efficiencySpan.textContent = `${efficiency}/s`;
        }
        
        // Función para actualizar la lista de palabras
        function updateWordsList(words = Array.from(wordsSet)) {
            wordsList.innerHTML = '';
            currentWords = words;
            
            if (words.length === 0) {
                wordsList.appendChild(emptyWords);
                emptyWords.style.display = 'block';
            } else {
                emptyWords.style.display = 'none';
                
                words.forEach(word => {
                    const li = document.createElement('li');
                    li.textContent = word;
                    wordsList.appendChild(li);
                });
            }
            
            updateStats();
        }
        
        // Función para actualizar palabras frecuentes
        function updateFrequentWords() {
            frequentWordsList.innerHTML = '';
            
            if (Object.keys(wordFrequency).length === 0) {
                frequentWordsList.appendChild(emptyFreq);
                emptyFreq.style.display = 'block';
                return;
            }
            
            emptyFreq.style.display = 'none';
            
            // Ordenar palabras por frecuencia
            const sortedByFrequency = Object.entries(wordFrequency)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 15); // Mostrar solo las 15 más frecuentes
            
            sortedByFrequency.forEach(([word, count]) => {
                const li = document.createElement('li');
                
                const wordSpan = document.createElement('span');
                wordSpan.textContent = word;
                
                const freqSpan = document.createElement('span');
                freqSpan.className = 'word-frequency';
                freqSpan.textContent = `${count} ocurrencias`;
                
                li.appendChild(wordSpan);
                li.appendChild(freqSpan);
                frequentWordsList.appendChild(li);
            });
        }
        
        // Función para actualizar la estructura del sitio
        function updateSiteStructure(links) {
            siteStructureList.innerHTML = '';
            
            if (links.length === 0) {
                siteStructureList.appendChild(emptyStructure);
                emptyStructure.style.display = 'block';
                return;
            }
            
            emptyStructure.style.display = 'none';
            
            // Mostrar los primeros 10 enlaces encontrados
            links.slice(0, 10).forEach(link => {
                const li = document.createElement('li');
                
                const linkSpan = document.createElement('span');
                linkSpan.textContent = link.title || link.url;
                
                const typeSpan = document.createElement('span');
                typeSpan.className = 'word-frequency';
                typeSpan.textContent = link.type === 'internal' ? 'Interno' : 'Externo';
                
                li.appendChild(linkSpan);
                li.appendChild(typeSpan);
                siteStructureList.appendChild(li);
            });
        }
        
        // Función para extraer palabras de una página web
        async function scrapeWords(url) {
            try {
                loading.style.display = 'block';
                loadingText.textContent = 'Iniciando análisis...';
                showMessage('Preparando el análisis de la página web...', 'info');
                scrapeStartTime = Date.now();
                
                // Configurar pasos de progreso
                const steps = [
                    'Conectando con el servidor',
                    'Descargando contenido principal',
                    'Extrayendo enlaces internos',
                    'Analizando páginas secundarias',
                    'Procesando texto y palabras',
                    'Generando estadísticas'
                ];
                
                setupProgressSteps(steps);
                updateProgress(0, 'Iniciando...');
                
                // Obtener configuración
                const depth = parseInt(depthSelect.value);
                const pageLimit = parseInt(pageLimitInput.value);
                const minLength = parseInt(minLengthInput.value);
                const filterCommon = filterCommonCheckbox.checked;
                const includeExternal = includeExternalCheckbox.checked;
                const timeout = parseInt(timeoutInput.value) * 1000; // Convertir a milisegundos
                
                // Simular proceso de scraping con barra de progreso
                await simulateScrapingProcess(url, depth, pageLimit, minLength, filterCommon, includeExternal, timeout);
                
                showMessage(`Análisis completado. Se analizaron ${pagesAnalyzed} páginas y se encontraron ${wordsSet.size} palabras únicas.`, 'success');
                loading.style.display = 'none';
                
            } catch (error) {
                console.error('Error al extraer palabras:', error);
                showMessage(`Error: ${error.message}`, 'error');
                loading.style.display = 'none';
            }
        }
        
        // Función para simular el proceso de scraping con barra de progreso
        async function simulateScrapingProcess(url, depth, pageLimit, minLength, filterCommon, includeExternal, timeout) {
            // Paso 1: Conectando con el servidor
            updateProgress(10, 'Conectando con el servidor...');
            updateProgressStep(0, 'active');
            await delay(1000);
            updateProgressStep(0, 'completed');
            
            // Paso 2: Descargando contenido principal
            updateProgress(25, 'Descargando contenido principal...');
            updateProgressStep(1, 'active');
            await delay(1500);
            
            // Simular datos de ejemplo para la página principal
            const sampleText = `
                El desarrollo web es el proceso de crear sitios web y aplicaciones para internet. 
                Incluye diseño web, desarrollo de contenido web, scripting del lado del cliente y del servidor, 
                y configuración de seguridad de red, entre otras tareas. El desarrollo web puede variar desde 
                desarrollar una simple página de texto plano hasta complejas aplicaciones web, negocios 
                electrónicos y servicios de redes sociales. Las tecnologías web fundamentales incluyen HTML, 
                CSS y JavaScript, junto con frameworks y librerías modernas como React, Angular y Vue.
            `;
            
            processText(sampleText, minLength, filterCommon);
            pagesAnalyzed = 1;
            updateProgressStep(1, 'completed');
            
            // Paso 3: Extrayendo enlaces internos
            updateProgress(40, 'Extrayendo enlaces internos...');
            updateProgressStep(2, 'active');
            await delay(1200);
